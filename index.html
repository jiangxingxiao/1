<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>临时粘贴站点</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #inputArea, #saveArea, #trashArea { border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; }
    #inputArea textarea { width: 100%; height: 100px; }
    .saveBtn, .clearBtn { margin: 5px; }
    .item { border-bottom: 1px solid #eee; padding: 5px 0; }
    .itemDetails { display: none; }
    .showMore { color: blue; cursor: pointer; }
    .countdown { font-size: 12px; color: gray; }
  </style>
</head>
<body>

  <div id="inputArea">
    <h2>文本输入区</h2>
    <textarea id="textInput" maxlength="10000" placeholder="输入文本..."></textarea>
    <div>字符计数: <span id="charCount">0</span>/10000</div>
    <div>
      <button class="saveBtn" data-time="120">保存 120秒</button>
      <button class="saveBtn" data-time="600">保存 600秒</button>
      <button class="saveBtn" data-time="1800">保存 1800秒</button>
      <button class="saveBtn" data-time="3600">保存 3600秒</button>
      <button class="saveBtn" data-time="86400">保存 1天</button>
      <button class="saveBtn" data-time="259200">保存 3天</button>
    </div>
    <button id="clearBtn">清除</button>
  </div>

  <div id="saveArea">
    <h2>保存区 (0/20)</h2>
    <div id="savedItems"></div>
  </div>

  <div id="trashArea">
    <h2>垃圾区</h2>
    <div id="trashItems"></div>
  </div>

  <script>
    const textInput = document.getElementById('textInput');
    const charCount = document.getElementById('charCount');
    const saveBtns = document.querySelectorAll('.saveBtn');
    const clearBtn = document.getElementById('clearBtn');
    const savedItems = document.getElementById('savedItems');
    const trashItems = document.getElementById('trashItems');
    const saveArea = document.getElementById('saveArea');

    let savedCount = 0;

    textInput.addEventListener('input', () => {
      charCount.textContent = textInput.value.length;
    });

    saveBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        if (savedCount >= 20) {
          moveOldestToTrash();
        }
        saveText(textInput.value, btn.getAttribute('data-time'));
        textInput.value = '';
        charCount.textContent = 0;
      });
    });

    clearBtn.addEventListener('click', () => {
      moveToTrash(textInput.value);
      textInput.value = '';
      charCount.textContent = 0;
    });

    function saveText(text, time) {
      const item = document.createElement('div');
      item.className = 'item';
      item.innerHTML = `
        <div>
          <span class="countdown">${formatTime(time)}</span>
          <span class="text">${text.length > 100 ? text.substring(0, 100) + '...' : text}</span>
          <button class="deleteBtn">删除</button>
          <button class="copyBtn">复制</button>
          <span class="showMore">显示更多</span>
        </div>
        <div class="itemDetails">${text}</div>
      `;
      savedItems.appendChild(item);
      savedCount++;
      updateSaveCount();
      startCountdown(item, time);

      const deleteBtn = item.querySelector('.deleteBtn');
      deleteBtn.addEventListener('click', () => {
        if (confirm('确定删除该条目？')) {
          item.remove();
          savedCount--;
          updateSaveCount();
        }
      });

      const copyBtn = item.querySelector('.copyBtn');
      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(text);
      });

      const showMore = item.querySelector('.showMore');
      showMore.addEventListener('click', () => {
        const details = item.querySelector('.itemDetails');
        if (details.style.display === 'none') {
          details.style.display = 'block';
          showMore.textContent = '隐藏';
        } else {
          details.style.display = 'none';
          showMore.textContent = '显示更多';
        }
      });
    }

    function startCountdown(item, time) {
      const countdownElement = item.querySelector('.countdown');
      let remainingTime = parseInt(time);
      const interval = setInterval(() => {
        if (remainingTime <= 0) {
          clearInterval(interval);
          item.remove();
          savedCount--;
          updateSaveCount();
        } else {
          remainingTime--;
          countdownElement.textContent = formatTime(remainingTime);
        }
      }, 1000);
    }

    function formatTime(seconds) {
      const hrs = Math.floor(seconds / 3600);
      const mins = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;
      return `${hrs}h ${mins}m ${secs}s`;
    }

    function updateSaveCount() {
      saveArea.querySelector('h2').textContent = `保存区 (${savedCount}/20)`;
    }

    function moveToTrash(text) {
      const item = document.createElement('div');
      item.className = 'item';
      item.innerHTML = `
        <div class="text">${text.length > 100 ? text.substring(0, 100) + '...' : text}</div>
      `;
      trashItems.appendChild(item);
      startTrashCountdown(item);
    }

    function startTrashCountdown(item) {
      let remainingTime = 120;
      const interval = setInterval(() => {
        if (remainingTime <= 0) {
          clearInterval(interval);
          item.remove();
        } else {
          remainingTime--;
        }
      }, 1000);
    }

    function moveOldestToTrash() {
      const oldestItem = savedItems.querySelector('.item');
      if (oldestItem) {
        moveToTrash(oldestItem.querySelector('.itemDetails').textContent);
        oldestItem.remove();
        savedCount--;
        updateSaveCount();
      }
    }
  </script>

</body>
</html>
